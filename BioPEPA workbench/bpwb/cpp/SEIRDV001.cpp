// StochKit input generated by the Bio-PEPA Workbench 1.0 "Charlie Mingus"

#include "ProblemDefinition.h"
#include <iostream>
#include <stdlib.h>
#include <math.h>


/* Constants for reaction identifiers */
#define ___infect 0
#define ___infectcount 1
#define ___incubate 2
#define ___recover 3
#define ___death 4
#define ___vaccinateS 5
#define ___vaccinateR 6
#define ___REACTIONS 7


/* Constants for species identifiers */
#define ___S   0
#define    S   ___discreteSpeciesCount(0)
#define ___E   1
#define    E   ___discreteSpeciesCount(1)
#define ___I   2
#define    I   ___discreteSpeciesCount(2)
#define ___R   3
#define    R   ___discreteSpeciesCount(3)
#define ___D   4
#define    D   ___discreteSpeciesCount(4)
#define ___V   5
#define    V   ___discreteSpeciesCount(5)
#define ___CUMI   6
#define    CUMI   ___discreteSpeciesCount(6)
#define ___SPECIES 7

/* Reaction constants */
double
    placeholder = 1,
    vaccinerate = 1,
    delta = 0.5,
    gamma1 = 0.196,
    alpha = 0.004;


Matrix Stoichiometry ()
{
  Matrix ___stoichiometry(___SPECIES, ___REACTIONS, 0.0);

  /* S = (infect, 1) << S + (vaccinateS, 1) << S */
  ___stoichiometry(___S, ___infect) = -1;
  ___stoichiometry(___S, ___vaccinateS) = -1;

  /* E = (infect, 1) >> E + (incubate, 1) << E */
  ___stoichiometry(___E, ___infect) = +1;
  ___stoichiometry(___E, ___incubate) = -1;

  /* I = (infect, 0) >> I + (incubate, 1) >> I + (recover, 1) << I + (death, 1) << I */
  ___stoichiometry(___I, ___infect) = +0;
  ___stoichiometry(___I, ___incubate) = +1;
  ___stoichiometry(___I, ___recover) = -1;
  ___stoichiometry(___I, ___death) = -1;

  /* R = (recover, 1) >> R + (vaccinateR, 1) << R */
  ___stoichiometry(___R, ___recover) = +1;
  ___stoichiometry(___R, ___vaccinateR) = -1;

  /* D = (death, 1) >> D */
  ___stoichiometry(___D, ___death) = +1;

  /* V = (vaccinateS, 1) >> V + (vaccinateR, 1) >> V */
  ___stoichiometry(___V, ___vaccinateS) = +1;
  ___stoichiometry(___V, ___vaccinateR) = +1;

  /* CUMI = (infectcount, 1) >> CUMI */
  ___stoichiometry(___CUMI, ___infectcount) = +1;

  return ___stoichiometry;
}

Vector Initialize ()
{

  /* Reaction constant initialisation */
  placeholder = 1;
  vaccinerate = 1;
  delta = 0.5;
  gamma1 = 0.196;
  alpha = 0.004;

  Vector ___initialSpeciesCount(___SPECIES, 0.0);
  ___initialSpeciesCount(___S) = 60000000;
  ___initialSpeciesCount(___E) = 12;
  ___initialSpeciesCount(___I) = 0;
  ___initialSpeciesCount(___R) = 0;
  ___initialSpeciesCount(___D) = 0;
  ___initialSpeciesCount(___V) = 0;
  ___initialSpeciesCount(___CUMI) = 0;
  return ___initialSpeciesCount;
}

#include "KineticFunctions.cpp"

Vector Propensity (const Vector& ___discreteSpeciesCount, double t)
{
  Vector ___propensity(___REACTIONS);

  /*      infect = [(I*(S+R+V)*(alpha+gamma1)*placeholder)/(S+E+I+R+V)] */
  ___propensity(___infect) = ((I*(S+R+V)*(alpha+gamma1)*placeholder)/(S+E+I+R+V));

  /*      infectcount = [(I*(S+R+V)*(alpha+gamma1)*placeholder)/(S+E+I+R+V)] */
  ___propensity(___infectcount) = ((I*(S+R+V)*(alpha+gamma1)*placeholder)/(S+E+I+R+V));

  /*      incubate = [delta*E] */
  ___propensity(___incubate) = (delta*E);

  /*      recover = [gamma1*I] */
  ___propensity(___recover) = (gamma1*I);

  /*      death = [alpha*I] */
  ___propensity(___death) = (alpha*I);

  /*      vaccinateS = [S*vaccinerate/(S+R)] */
  ___propensity(___vaccinateS) = (S*vaccinerate/(S+R));

  /*      vaccinateR = [R*vaccinerate/(S+R)] */
  ___propensity(___vaccinateR) = (R*vaccinerate/(S+R));
  return ___propensity;
}
