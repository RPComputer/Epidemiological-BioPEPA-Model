/*
 *  SIRDV001_cv.c
 *
 *  CVODE C file for the vector field named: SIRDV001
 *
 *  This file was generated by the program VFGEN, version: 2.6.0.dev3
 *  Generated on 21-Sep-2022 at 01:40
 */

#include "CustomFunctions.c"
#include <math.h>

/* Include headers for CVODE 2.5.0 */
#include <sundials/sundials_types.h>
#include <sundials/sundials_dense.h>
#include <sundials/sundials_nvector.h>
#include <nvector/nvector_serial.h>
#include <cvode/cvode.h>
#include <cvode/cvode_dense.h>

/*
 *  The vector field.
 */

int SIRDV001_vf(realtype t, N_Vector y_, N_Vector f_, void *params)
{
    realtype S_, I_, R_, D_, V_;
    realtype placeholder_, vaccinerate_, gamma1_, alpha_;
    realtype infect_, recover_, death_, vaccinateS_, vaccinateR_;
    realtype *p_;

    p_ = (realtype *) params;

    S_         = NV_Ith_S(y_,0);
    I_         = NV_Ith_S(y_,1);
    R_         = NV_Ith_S(y_,2);
    D_         = NV_Ith_S(y_,3);
    V_         = NV_Ith_S(y_,4);

    placeholder_ = p_[0];
    vaccinerate_ = p_[1];
    gamma1_    = p_[2];
    alpha_     = p_[3];

    infect_ = ( gamma1_+alpha_)*I_/( S_+V_+I_+R_)*readRt(t, "Rt.csv")*( S_+V_+R_);
    recover_ = gamma1_*I_;
    death_ = I_*alpha_;
    vaccinateS_ = S_/( S_+R_)*readDatatable(t, "vacciniSIRDV.csv", "n");
    vaccinateR_ = R_/( S_+R_)*readDatatable(t, "vacciniSIRDV.csv", "n");

    NV_Ith_S(f_,0) = -vaccinateS_-infect_;
    NV_Ith_S(f_,1) = -recover_-death_+infect_;
    NV_Ith_S(f_,2) =  recover_-vaccinateR_;
    NV_Ith_S(f_,3) = death_;
    NV_Ith_S(f_,4) =  vaccinateS_+vaccinateR_;
    return 0;
}

/*
 *  The Jacobian.
 */

int SIRDV001_jac(long int N_, DenseMat jac_, realtype t,
                N_Vector y_, N_Vector fy_, void *params,
                N_Vector tmp1, N_Vector tmp2, N_Vector tmp3)
{
    realtype S_, I_, R_, D_, V_;
    realtype placeholder_, vaccinerate_, gamma1_, alpha_;
    realtype *p_;

    p_ = (realtype *) params;

    S_         = NV_Ith_S(y_,0);
    I_         = NV_Ith_S(y_,1);
    R_         = NV_Ith_S(y_,2);
    D_         = NV_Ith_S(y_,3);
    V_         = NV_Ith_S(y_,4);

    placeholder_ = p_[0];
    vaccinerate_ = p_[1];
    gamma1_    = p_[2];
    alpha_     = p_[3];

    DENSE_ELEM(jac_, 0, 0) =  ( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)+S_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n")-( gamma1_+alpha_)*I_/( S_+V_+I_+R_)*readRt(t, "Rt.csv")-1.0/( S_+R_)*readDatatable(t, "vacciniSIRDV.csv", "n");
    DENSE_ELEM(jac_, 0, 1) =  ( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)-( gamma1_+alpha_)/( S_+V_+I_+R_)*readRt(t, "Rt.csv")*( S_+V_+R_);
    DENSE_ELEM(jac_, 0, 2) =  ( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)+S_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n")-( gamma1_+alpha_)*I_/( S_+V_+I_+R_)*readRt(t, "Rt.csv");
    DENSE_ELEM(jac_, 0, 4) =  ( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)-( gamma1_+alpha_)*I_/( S_+V_+I_+R_)*readRt(t, "Rt.csv");
    DENSE_ELEM(jac_, 1, 0) = -( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)+( gamma1_+alpha_)*I_/( S_+V_+I_+R_)*readRt(t, "Rt.csv");
    DENSE_ELEM(jac_, 1, 1) = -( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)-gamma1_-alpha_+( gamma1_+alpha_)/( S_+V_+I_+R_)*readRt(t, "Rt.csv")*( S_+V_+R_);
    DENSE_ELEM(jac_, 1, 2) = -( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)+( gamma1_+alpha_)*I_/( S_+V_+I_+R_)*readRt(t, "Rt.csv");
    DENSE_ELEM(jac_, 1, 4) = -( gamma1_+alpha_)*I_/pow( S_+V_+I_+R_,2.0)*readRt(t, "Rt.csv")*( S_+V_+R_)+( gamma1_+alpha_)*I_/( S_+V_+I_+R_)*readRt(t, "Rt.csv");
    DENSE_ELEM(jac_, 2, 0) = R_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n");
    DENSE_ELEM(jac_, 2, 1) = gamma1_;
    DENSE_ELEM(jac_, 2, 2) =  R_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n")-1.0/( S_+R_)*readDatatable(t, "vacciniSIRDV.csv", "n");
    DENSE_ELEM(jac_, 3, 1) = alpha_;
    DENSE_ELEM(jac_, 4, 0) = -R_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n")-S_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n")+1.0/( S_+R_)*readDatatable(t, "vacciniSIRDV.csv", "n");
    DENSE_ELEM(jac_, 4, 2) = -R_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n")-S_/pow( S_+R_,2.0)*readDatatable(t, "vacciniSIRDV.csv", "n")+1.0/( S_+R_)*readDatatable(t, "vacciniSIRDV.csv", "n");
    return 0;
}
