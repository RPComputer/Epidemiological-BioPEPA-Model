/*
 *  testRtFile001_cv.c
 *
 *  CVODE C file for the vector field named: testRtFile001
 *
 *  This file was generated by the program VFGEN, version: 2.6.0.dev3
 *  Generated on 25-Jul-2022 at 18:28
 */

#include <math.h>

/* Include headers for CVODE 2.5.0 */
#include <sundials/sundials_types.h>
#include <sundials/sundials_dense.h>
#include <sundials/sundials_nvector.h>
#include <nvector/nvector_serial.h>
#include <cvode/cvode.h>
#include <cvode/cvode_dense.h>

/*
 *  The vector field.
 */

int testRtFile001_vf(realtype t, N_Vector y_, N_Vector f_, void *params)
{
    realtype S_, I_, R_, D_;
    realtype k1_, k2_, k3_, C_Rt;
    realtype infect_, recover_, death_;
    realtype *p_;

    p_ = (realtype *) params;

    S_         = NV_Ith_S(y_,0);
    I_         = NV_Ith_S(y_,1);
    R_         = NV_Ith_S(y_,2);
    D_         = NV_Ith_S(y_,3);

    k1_        = p_[0];
    k2_        = p_[1];
    k3_        = p_[2];
    C_Rt       = p_[3];

    infect_ = t/k2_*S_*k3_*I_*C_Rt*k1_*( R_+S_+I_);
    recover_ = k2_*I_;
    death_ = k3_*I_;

    NV_Ith_S(f_,0) = -infect_;
    NV_Ith_S(f_,1) = -death_+infect_-recover_;
    NV_Ith_S(f_,2) = recover_;
    NV_Ith_S(f_,3) = death_;
    return 0;
}

/*
 *  The Jacobian.
 */

int testRtFile001_jac(long int N_, DenseMat jac_, realtype t,
                N_Vector y_, N_Vector fy_, void *params,
                N_Vector tmp1, N_Vector tmp2, N_Vector tmp3)
{
    realtype S_, I_, R_, D_;
    realtype k1_, k2_, k3_, C_Rt;
    realtype *p_;

    p_ = (realtype *) params;

    S_         = NV_Ith_S(y_,0);
    I_         = NV_Ith_S(y_,1);
    R_         = NV_Ith_S(y_,2);
    D_         = NV_Ith_S(y_,3);

    k1_        = p_[0];
    k2_        = p_[1];
    k3_        = p_[2];
    C_Rt       = p_[3];

    DENSE_ELEM(jac_, 0, 0) = -t/k2_*S_*k3_*I_*C_Rt*k1_-t/k2_*k3_*I_*C_Rt*k1_*( R_+S_+I_);
    DENSE_ELEM(jac_, 0, 1) = -t/k2_*S_*k3_*I_*C_Rt*k1_-t/k2_*S_*k3_*C_Rt*k1_*( R_+S_+I_);
    DENSE_ELEM(jac_, 0, 2) = -t/k2_*S_*k3_*I_*C_Rt*k1_;
    DENSE_ELEM(jac_, 1, 0) =  t/k2_*S_*k3_*I_*C_Rt*k1_+t/k2_*k3_*I_*C_Rt*k1_*( R_+S_+I_);
    DENSE_ELEM(jac_, 1, 1) = -k2_+t/k2_*S_*k3_*I_*C_Rt*k1_-k3_+t/k2_*S_*k3_*C_Rt*k1_*( R_+S_+I_);
    DENSE_ELEM(jac_, 1, 2) = t/k2_*S_*k3_*I_*C_Rt*k1_;
    DENSE_ELEM(jac_, 2, 1) = k2_;
    DENSE_ELEM(jac_, 3, 1) = k3_;
    return 0;
}
